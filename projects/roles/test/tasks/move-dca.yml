- name: Include credentials for connecting to the HMC
  include_vars:
    file: credentials.yml


- name: Shutting down {{item.lpar.name}} LPAR in DCA
  ansible.builtin.script: 'shutdownLPAR.sh {{item.lpar.name}} {{hmc_user}} {{hmc_hostname}} {{item.lpar.PRI_SYS}}' 

- name: Suspend Global Mirror {{item.lpar.name}}
  ansible.builtin.script: 'suspendGM.sh {{item.lpar.name}}'

- name: Recover Global Mirror {{item.lpar.name}}
  ansible.builtin.script: 'recoverGM.sh {{item.lpar.name}}' 

- name: Activating {{item.lpar.name}} LPAR in DCP
  ansible.builtin.script: 'activateLPAR.sh {{item.lpar.name}} {{hmc_user}} {{hmc_hostname}} {{item.lpar.SEC_SYS}}'

#- name: Debug Messages
  #debug:
    #msg: '{{resultado}}'